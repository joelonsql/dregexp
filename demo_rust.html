
<!DOCTYPE html>
<html>
    <head>
        <title>Demo - dregexp</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, maximum-scale=1.0">
        <meta name="theme-color" content="#ffffff">
        <link rel="stylesheet" href="Treant.css">
        <link rel="stylesheet" href="demo.css">
        <script src="papaparse.js"></script>
        <script src="dregexp.js"></script>
        <script src="raphael.js"></script>
        <script src="Treant.js"></script>
        <script src="jquery.min.js"></script>
        <script src="jquery.easing.js"></script>
        <script src="demo_rust.js"></script>
        <script src="jquery.jexcel.js"></script>
        <link rel="stylesheet" href="jquery.jexcel.css" type="text/css" />
    </head>
    <body>
        <h1>Demo of dregexp</h1>
        <div>Check out View -> Developer -> Develope Tools -> Console</div>
        <textarea id="inputString" rows="10" cols="100" oninput="parseAndDrawTree()">struct G<S,T>{x:S,y:T}
fn f<S,T>(){let x:S;let y:T;}
fn g(a:bool,b:bool){}
struct A{}
struct B{}
fn main(){
let S:i32=1;
let T:i32=2;
let E:i32=5;
g(E<S,T>3);
f::<G<A,B>,i32>();
}
</textarea>
        <br/>
        <input type="checkbox" id="eliminateUselessNodes" onchange="parseAndDrawTree()" checked="checked"/>Eliminate useless nodes
        <br/>
        <div class="chart" id="parseTree"></div>
        <div class="chart" id="parseTree2"></div>
        <button id='reloadGrammar'>Reload grammar</button>
        <button id='emptyGrammar'>Empty grammar</button>
        <div id="mytable"></div>
        <script>
            parseAndDrawTree();
            $('#reloadGrammar').on('click', function () {
                let data = $('#mytable').jexcel('getData');
                let newGrammar = [];
                for (let row of data) {
                    newGrammar.push({parser: row[0], nodetype: row[1], tokenizepattern: row[2], parsepattern: row[3], primitivetype: row[4], nodegroup: row[5], precedence: row[6], subparser: row[7]});
                }
                drx = new DRegExp();
                drx.loadGrammarRules(newGrammar);
                parseAndDrawTree();
            });
            $('#emptyGrammar').on('click', function () {
                $('#mytable').jexcel({
                    data:[['','','','','','','']],
                    colWidths: [ 100, 100, 100, 300, 100, 100, 100, 100 ],
                    colHeaders: [ 'parser', 'nodeType', 'tokenizePattern', 'parsePattern', 'primitiveType', 'nodeGroup', 'precedence', 'subParser' ]
                });
                drx = new DRegExp();
                parseAndDrawTree();
            });
        </script>
    </body>
</html>